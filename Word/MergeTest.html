<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml">
	<head>
		<meta http-equiv="content-type" content="text/html; charset=utf-8"/>
	    <title>AVS Document Editor</title>
	    <meta http-equiv="X-UA-Compatible" content="IE=9"/>
		
		<!-- <script type="text/javascript" src="utils.js"></script> -->		

		<script type="text/javascript" src="menu/js/jquery-1.6.1.min.js"></script>
		<script src="../Common/Merge/NodejsEnv.js"></script>
		<script src="../Common/downloaderfiles.js"></script>
		<script src="../Common/docscoapisettings.js"></script>
		<script src="../Common/docscoapicommon.js"></script>
        <script type="text/javascript" src="../Common/spellCheckLanguage.js"></script>
        <script type="text/javascript" src="../Common/spellCheckLanguagesAll.js"></script>
		<script type="text/javascript" src="../Common/3rdparty/Underscore/underscore-min.js"></script>
        <script type="text/javascript" src="../Common/3rdparty/Sockjs/sockjs-0.3.min.js"></script>
		<script type="text/javascript" src="../Common/3rdparty/XRegExp/xregexp-all.js"></script>
		<script type="text/javascript" src="../Common/docscoapi.js"></script>
		<script type="text/javascript" src="../Common/spellcheckapisettings.js"></script>
        <script type="text/javascript" src="../Common/spellcheckapi.js"></script>
        <script type="text/javascript" src="../Common/wordcopypaste.js"></script>
		<script type="text/javascript" src="../Common/CommonDefines.js"></script>
		<script type="text/javascript" src="../Common/NumFormat.js"></script>
		<script type="text/javascript" src="../Common/editorscommon.js"></script>

		<!-- For chart editor -->
		<script type="text/javascript" src="../Excel/apiDefines.js"></script>
		<script type="text/javascript" src="../Common/Charts/DrawingObjects.js"></script>
		<script type="text/javascript" src="../Common/Charts/charts.js"></script>
		<script type="text/javascript" src="../Common/SerializeCommonWordExcel.js"></script>
		<script src="../Common/Charts/libraries/OfficeExcel.common.core.js"></script>
		<script src="../Common/Charts/libraries/OfficeExcel.common.annotate.js"></script>
		<script src="../Common/Charts/libraries/OfficeExcel.common.context.js"></script>
		<script src="../Common/Charts/libraries/OfficeExcel.common.effects.js"></script>
		<script src="../Common/Charts/libraries/OfficeExcel.common.key.js"></script>
		<script src="../Common/Charts/libraries/OfficeExcel.common.resizing.js"></script>
		<script src="../Common/Charts/libraries/OfficeExcel.common.zoom.js"></script>
		<script src="../Common/Charts/libraries/OfficeExcel.bar.js"></script>
		<script src="../Common/Charts/libraries/OfficeExcel.hbar.js"></script>
		<script src="../Common/Charts/libraries/OfficeExcel.line.js"></script>
		<script src="../Common/Charts/libraries/OfficeExcel.pie.js"></script>
		<script src="../Common/Charts/libraries/OfficeExcel.scatter.js"></script>
		<script src="../Common/Charts/libraries/OfficeExcel.chartProperties.js"></script>

        <script src="../Common/FontsFreeType/font_engine.js"></script>

        <script src="../Common/FontsFreeType/FontFile.js"></script>
        <script src="../Common/FontsFreeType/FontManager.js"></script>
        <script src="Drawing/Externals.js"></script>
        <script src="../Common/AllFonts.js"></script>
        <script src="Drawing/GlobalLoaders.js"></script>

        <script type="text/javascript" src="Drawing/translations.js"></script>

        <script type="text/javascript" src="Editor/GraphicObjects/GraphicObjects.js"></script>
        <script type="text/javascript" src="Editor/GraphicObjects/GraphicPage.js"></script>
        <script type="text/javascript" src="Editor/GraphicObjects/States.js"></script>
        <script type="text/javascript" src="Editor/GraphicObjects/Math.js"></script>
        <script type="text/javascript" src="Editor/GraphicObjects/TrackGraphicObjects.js"></script>
        <script type="text/javascript" src="Editor/GraphicObjects/WrapManager.js"></script>
        <script type="text/javascript" src="Editor/GraphicObjects/Spline.js"></script>
        <script type="text/javascript" src="Editor/GraphicObjects/PolyLine.js"></script>


        <script type="text/javascript" src="Editor/GraphicObjects/ObjectTypes/WordShape.js"></script>
        <script type="text/javascript" src="Editor/GraphicObjects/ObjectTypes/WordImage.js"></script>
        <script type="text/javascript" src="Editor/GraphicObjects/ObjectTypes/WordGroupShapes.js"></script>
        <script type="text/javascript" src="Editor/GraphicObjects/ObjectTypes/Format.js"></script>
        <script type="text/javascript" src="Editor/GraphicObjects/ObjectTypes/Geometry.js"></script>
        <script type="text/javascript" src="Editor/GraphicObjects/ObjectTypes/ShapeTracks.js"></script>
        <script type="text/javascript" src="Editor/GraphicObjects/ObjectTypes/GroupTracks.js"></script>
        <script type="text/javascript" src="Editor/GraphicObjects/ObjectTypes/CreateGeometry.js"></script>
        <script type="text/javascript" src="Editor/GraphicObjects/ObjectTypes/Path.js"></script>

        <script type="text/javascript" src="Editor/CollaborativeEditing.js"></script>
        <script type="text/javascript" src="Editor/Comments.js"></script>
        <script type="text/javascript" src="Editor/History.js"></script>
        <script type="text/javascript" src="Editor/Styles.js"></script>
        <script type="text/javascript" src="Editor/DrawingObjects.js"></script>
        <script type="text/javascript" src="Editor/FlowObjects.js"></script>
	    <script type="text/javascript" src="Editor/ParagraphContent.js"></script>
	    <script type="text/javascript" src="Editor/Paragraph.js"></script>
	    <script type="text/javascript" src="Editor/Sections.js"></script>
        <script type="text/javascript" src="Editor/Numbering.js"></script>
        <script type="text/javascript" src="Editor/HeaderFooter.js"></script>
	    <script type="text/javascript" src="Editor/Document.js"></script>
	    <script type="text/javascript" src="Editor/Common.js"></script>
		<script type="text/javascript" src="Editor/Numbering.js"></script>
        <script type="text/javascript" src="Editor/DocumentContent.js"></script>
        <script type="text/javascript" src="Editor/Table.js"></script>
		<script type="text/javascript" src="Editor/Serialize2.js"></script>
        <script type="text/javascript" src="Editor/Search.js"></script>
        <script type="text/javascript" src="Editor/FontClassification.js"></script>
        <script type="text/javascript" src="Editor/Spelling.js"></script>

        <script type="text/javascript" src="Drawing/Graphics.js"></script>
        <script type="text/javascript" src="Drawing/ArcTo.js"></script>
        <script type="text/javascript" src="Drawing/Hit.js"></script>
        <script type="text/javascript" src="Drawing/ColorArray.js"></script>
        <script type="text/javascript" src="Drawing/Overlay.js"></script>
        <script type="text/javascript" src="Drawing/ShapeDrawer.js"></script>
        <script type="text/javascript" src="Drawing/Metafile.js"></script>
        <script type="text/javascript" src="Drawing/DrawingDocument.js"></script>
        <script type="text/javascript" src="Drawing/GraphicsEvents.js"></script>
        <script type="text/javascript" src="../Common/Scrolls/iscroll.js"></script>
        <script type="text/javascript" src="Drawing/WorkEvents.js"></script>
        <script type="text/javascript" src="Drawing/Controls.js"></script>
        <script type="text/javascript" src="Drawing/Rulers.js"></script>
        <script type="text/javascript" src="Drawing/HtmlPage.js"></script>
        <script type="text/javascript" src="Drawing/documentrenderer.js"></script>
		<script type="text/javascript" src="apiDefines.js"></script>
        <script type="text/javascript" src="apiCommon.js"></script>
		<script type="text/javascript" src="api.js"></script>
		<script type="text/javascript" src="document/empty.js"></script>
        <script type="text/javascript" src="merge/api_merge.js"></script>
        <script type="text/javascript" src="../Common/scroll.js"></script>

        <script type="text/javascript" src="../Common/Shapes/EditorSettings.js"></script>
        <script type="text/javascript" src="../Common/Shapes/Serialize.js"></script>
        <script type="text/javascript" src="../Common/Shapes/SerializeWriter.js"></script>
        <script type="text/javascript" src="../Common/SerializeCommonWordExcel.js"></script>
        <script type="text/javascript" src="Editor/SerializeCommon.js"></script>

		<!--for charts-->
		<script type="text/javascript" src="../Excel/graphics/DrawingContextWord.js"></script>
		
		<script type="text/javascript" src="merge/document/editor.js"></script>
		<script type="text/javascript" src="merge/document/changes/changes.js"></script>
		
		<script type="text/javascript" src="merge/api_merge.js"></script>

    </head>
    <body>
		<p>See the console log.</p>
		<script>
			//var sdk_all = require('../sdk-all.js');
			var editor = new asc_docs_merge_api();
			
			console.log("Base document:", base_doc);
			
			//var fs = require('fs');
			//var base_doc = fs.readFileSync(base_file, 'utf-8');
			editor.LoadDocument( base_doc );

			console.log("Changes:", doc_changes);
			
			//var doc_changes = require(changes_file);
			editor.ApplyChanges( doc_changes );

			var changed_doc = editor.Save();
			//fs.writeFileSync(output_file, changed_doc, 'utf-8');
			
			console.log("Merged document:", changed_doc);
		</script>
	</body>
</html>